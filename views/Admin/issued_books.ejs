<%-include ("../Includes/Admin/head.ejs")%>

  <body>
    <%-include ("../Includes/Admin/header.ejs")%>
      <!-- ======= Sidebar ======= -->
      <aside id="sidebar" class="sidebar">
        <ul class="sidebar-nav" id="sidebar-nav">

          <li class="nav-item">
            <a class="nav-link collapsed" href="/admin/dashboard">
              <i class="bi bi-columns-gap"></i>
              <span>Dashboard</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link collapsed" href="/admin/students">
              <i class="bi bi-people"></i>
              <span>Manage Students</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link collapsed" href="/admin/faculty">
              <i class="bi bi-person-vcard"></i>
              <span>Manage Faculty</span>
            </a>
          </li>
          <!-- End Dashboard Nav -->
          <li class="nav-item">
            <a class="nav-link collapsed" href="/admin/attendance">
              <i class="bi bi-table"></i>
              <span>Attendance</span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link " data-bs-target="#book-nav" data-bs-toggle="collapse" href="#">
              <i class="bi bi-book-half"></i><span>Books</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="book-nav" class="nav-content collapse show " data-bs-parent="#sidebar-nav">
              <li>
                <a href="/admin/all_books">
                  <i class="bi bi-circle"></i><span>All Books</span>
                </a>
              </li>
              <li>
                <a href="/admin/issued_books" class="active">
                  <i class="bi bi-circle"></i><span>Currently Issued</span>
                </a>
              </li>
              <li>
                <a href="/admin/issue_request">
                  <i class="bi bi-circle"></i><span>Issued Request</span>
                </a>
              </li>
              <li>
                <a href="/admin/renew_request">
                  <i class="bi bi-circle"></i><span>Renew Request</span>
                </a>
              </li>
              <li>
                <a href="/admin/return_request">
                  <i class="bi bi-circle"></i><span>Return Request</span>
                </a>
              </li>


              <li>
                <a href="/admin/recommendations">
                  <i class="bi bi-check-circle"></i>
                  <span>Recommendations</span>
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link collapsed" href="/admin/messages">
              <i class="bi bi-chat"></i>
              <span>Messages</span>
            </a>
          </li>

        </ul>
      </aside>
      <!-- End Sidebar-->
      <main id="main" class="main">
        <div class="pagetitle">
          <h1>Books</h1>
          <nav>
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="/admin/dashboard">Home</a></li>
              <li class="breadcrumb-item active">Currently Issued</li>
            </ol>
          </nav>
        </div>
        <section class="section profile">
          <div class="row">



            <div class="card">
              <div class="card-body pt-3">
                <!-- Bordered Tabs -->
                <h5 class="card-title">
                  All Currently Issued Books
                </h5>

                <div class="table-responsive-md">
                  <table id="issuedBooksTable" class="table table-hover" style="width:100%">
                    <thead>
                      <tr>
                        <th>No.</th>
                        <th>Book ID</th>
                        <th>Title</th>
                        <th>User ID</th>
                        <th>Issued Date</th>
                        <th>Due Date</th>
                        <th>Renewal Count</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% issued_books.forEach((issued_book,index) => { %>
                        <tr>
                          <td>
                            <%=index + 1%>
                          </td>
                          <td>
                            <%= issued_book.book_id %>
                          </td>
                          <td>
                            <%=issued_book.title%>
                          </td>
                          <td>
                            <%= issued_book.user_id %>
                          </td>

                          <td>
                            <%= issued_book.issue_date.toLocaleString('en-US', { year: 'numeric' ,
                            month: 'long' , day: 'numeric' , hour: 'numeric' ,
                            minute: 'numeric' , hour12: true })  %>
                          </td>
                          <td>
                            <%= issued_book.due_date.toLocaleString('en-US', { year: 'numeric' ,
                            month: 'long' , day: 'numeric' , hour: 'numeric' ,
                            minute: 'numeric' , hour12: true })  %>
                          </td>
                          <td>
                            <%= issued_book.renewal_count %>
                          </td>
                        </tr>
                        <% }) %>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>


          </div>
        </section>

      </main>
      <!-- End #main -->
      <%-include ("../Includes/Admin/script.ejs")%>
        <script>
          $(document).ready(function () {
            $('#issuedBooksTable').DataTable();
          });
        </script>

  </body>

  </html>